angular.module("fullscreen.tv",["ngCookies","templates","angularFileUpload","segmentio"]).run(["segmentio","$rootScope",function(e,r){return r.$on("$stateChangeSuccess",e.page()),e.load("2kucux9fa2")}]),angular.module("fullscreen.tv").directive("upload",["$fileUploader","$location",function(e,r){return{restrict:"E",replace:!0,templateUrl:"upload.html",link:function(n){var t;return t=e.create({url:"/videos",alias:"video[file]",autoUpload:!0}),t.bind("completeall",function(){return t.clearQueue(),r.path("/uploads/manager")}),n.uploader=t}}}]),angular.module("fullscreen.tv").directive("uploadsManager",["$http","$timeout","$location","firebase","zencoder",function(e,r,n,t,o){return{restrict:"E",templateUrl:"../views/uploads_manager.html",link:function(e){var n,i,u;return e.uploads=t.getUploads(),e.uploads.$on("loaded",function(){return i()}),n=function(e,r){var n;return n=_.filter(e,function(e){return(null!=e?e.state:void 0)===r})},u=function(e){return _.each(e,function(e){return o.getJobProgress(e.id,e.job_id)})},i=function(t){var o,a,l,c;return null==t&&(t=5e3),o=u(n(e.uploads,"encoding")),a=u(n(e.uploads,"processing")),c=u(n(e.uploads,"waiting")),l=_.union(o,a,c),_.isEmpty(l)||r(function(){return l=i()},t),l},e.updateAllInWork=i},controller:["$scope",function(r){return r.kickOffJob=function(n){return e.post("videos/"+n+"/publish").then(function(){return r.updateAllInWork()})},r.removeUpload=function(r){return e["delete"]("videos/"+r)},r.watch=function(e,r){return"finished"===r?n.path("/watch/"+e):void 0}}]}}]),angular.module("gunslinger").constant("config",{env:"development",zencoder:{integration:"",read:"",full:""},firebase:{"default":"https://supernova.firebaseio.com/",uploads:"https://supernova.firebaseio.com/uploads",clock:"https://supernova.firebaseio.com/.info/serverTimeOffset"}}),angular.module("fullscreen.tv").run(["$cookies",function(e){var r,n;return n=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},r=function(){return""+n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},e.guid?void 0:e.guid=r()}]).service("firebase",["$firebase","$cookies","config","$rootScope","$q",function(e,r,n,t,o){var i,u,a;return i=new Firebase(n.firebase.clock),u=function(){var e;return e=o.defer(),i.on("value",function(r){var n;return n=Date.now()+r.val(),e.resolve(n)}),e.promise},a={users:e(new Firebase(n.firebase.users)),getServerTime:u}}]),angular.module("fullscreen.tv").service("liveSync",["firebase","$window",function(e,r){var n,t,o;return navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,n=r.AudioContext||r.webkitAudioContext,o=function(e,r,t){var o,i,u;return i=(r-e)%t,console.log("jumpTo (in seconds)",i/1e3),console.log("jumpTo (in minutes)",i/1e3/60),o={video:!1,audio:!0},u=function(e){var r,t,o;return r=new n,o=r.createMediaStreamSource(e),t=r.createBiquadFilter(),o.connect(t),t.connect(r.destination)},navigator.getMedia(o,u)},e.getServerTime().then(function(e){var r,n;return n=13956876e5,r=132e4,o(n,e,r)}),t={sync:o}}]),angular.module("fullscreen.tv").service("zencoder",["$http",function(e){return{getJobProgress:function(r,n){return e.post("videos/"+r+"/"+n+"/progress").then(function(e){return e.data})}}}]).config(["$httpProvider",function(e){return e.defaults.headers.common={},e.defaults.headers.post={},e.defaults.headers.post["Zencoder-Api-Key"]=""}]),angular.module("fullscreen.tv").directive("filepicker",["$window",function(e){return{restrict:"E",templateUrl:"filepicker.html",link:function(r){return r.filepicker=e.filepicker,r.filepicker.setKey("AiCDu1zCuQQysPoX9Mb9bz")},controller:["$scope",function(e){var r;return r={options:{container:"window",services:["COMPUTER","DROPBOX","BOX","GOOGLE_DRIVE","VIDEO","WEBCAM"]},success:function(e){return console.log("picker.success",e)},error:function(e){return console.log("picker.error",e)}},e.pick=function(n){return null==n&&(n={}),n=angular.extend(r.options,n),e.filepicker.pick(n,r.success,r.error)}}]}}]),angular.module("fullscreen.tv").directive("player",function(){return{restrict:"E",replace:!0,templateUrl:"player.html",scope:{video:"=",playlist:"="},link:function(e){return videojs("player").ready(function(){return e.player?void 0:(e.player=this,this.on("ended",function(){var r;return r=_.at(e.playlist,e.video.id),console.log("nextvideo",r)}))})},controller:["$scope",function(e){return e.$watch("playlist",function(r){var n;return console.log("playlist",r),e.video=getPlaybackVideo(r[null!=(n=e.video)?n.id:void 0])}),e.$watch("video",function(r){return r?void 0:e.video=getPlaybackVideo(null!=e?e.playlist[null!=r?r.id:void 0]:void 0)})}]}}),angular.module("fullscreen.tv").directive("upload",["$fileUploader","$location",function(e,r){return{restrict:"E",replace:!0,templateUrl:"upload.html",link:function(n){var t;return t=e.create({url:"/videos",alias:"video[file]",autoUpload:!0}),t.bind("completeall",function(){return t.clearQueue(),r.path("/uploads/manager")}),n.uploader=t}}}]);